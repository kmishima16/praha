# 寿司注文 データベース設計

## データベースの構成

![ER図](https://github.com/kmishima16/praha/blob/image/db_modeling_1/images/Copy%20of%20DB%E3%83%A2%E3%83%87%E3%83%AA%E3%83%B3%E3%82%B01%20%E5%AF%BF%E5%8F%B8%E6%B3%A8%E6%96%87DB.png)

- [dbdiagram.io](https://dbdiagram.io/d/DBモデリング1-寿司注文DB-65db06525cd0412774bf0ea7)で作成  

- [DDL](./docker-mysql/script/01DDL.sql)
- [DML](./docker-mysql/script/02DML.sql)

## ユースケース

- お客さんが注文する際の合計金額

```sql
-- VIEWを参照して注文合計額を確認する
mysql> SELECT * FROM `hoge-db`.order_amount;
+----------+-------------+--------------+
| order_id | customer_id | SUM(p.price) |
+----------+-------------+--------------+
|        1 |           1 |        10460 |
+----------+-------------+--------------+
1 row in set (0.00 sec)
```

- オーダーに対してのオプション付き商品

```sql
-- 注文のうち、オプション付きの商品
select 
  od.order_id as "注文ID",
  od.product_id as "商品ID",
  prd.name as "商品名",
  op.id as "オプションid",
  op.name as "オプション名"
from `order_details` as od
inner join `options` as op on od.option_id = op.id
inner join `products` as prd on od.product_id = prd.id;

+----+----+--------------+----+-----------------+
| ID | ID |              | id |                 |
+----+----+--------------+----+-----------------+
|  1 | 15 | 玉子         |  1 | わさび抜き      |
|  1 | 22 | ゆでげそ     |  2 | シャリ半分      |
+----+----+--------------+----+-----------------+
2 rows in set (0.00 sec)
```
